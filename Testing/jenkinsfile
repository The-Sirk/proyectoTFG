pipeline {
    agent any
    environment {
        REPO_URL = 'https://github.com/The-Sirk/proyectoTFG.git'
        BRANCH = 'Testing'
    }
    stages {
        stage('Clonar repositorio') {
            steps {
                git branch: "${BRANCH}", url: "${REPO_URL}"
            }
        }

        stage('Ejecutar Test Usuario') {
            steps {
                bat '\\Users\\RICK\\AppData\\Roaming\\npm\\newman run Testing\\Usuario.postman_collection.json -e Testing\\ENV-TFG-Usuario.postman_environment.json -d Testing\\CSV-Iterador-Test-usuario.csv -r htmlExtra --insecure --reporter-htmlExtra-export Testing\\newman\\Usuario\\ --suppress-exit-code'
            }
        }
        stage('Ejecutar Test Criticas') {
            steps {
                bat '\\Users\\RICK\\AppData\\Roaming\\npm\\newman run Testing\\criticas.postman_collection.json -e Testing\\ENV-TFG-criticas.postman_environment.json -r htmlExtra --insecure --reporter-htmlExtra-export Testing\\newman\\critica\\ --suppress-exit-code'
            }
        }
        stage('Ejecutar Test TMDB') {
            steps {
                bat '\\Users\\RICK\\AppData\\Roaming\\npm\\newman run Testing\\TMDB.postman_collection.json -e Testing\\ENV-TFG-TMDB.postman_environment.json -r htmlExtra --insecure --reporter-htmlExtra-export Testing\\newman\\TMDB\\ --suppress-exit-code'
            }
        }
        
        stage('Ejecutar copia de informes') {
            steps {
                bat 'xcopy Testing\\newman C:\\TFG\\proyectoTFG\\Testing\\newman/E /H /Y'
            }
        }
        
   }
        post {
            always {
                echo "Fin de jenkinsfile "
            }
        }
    
}